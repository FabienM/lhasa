name: Applications Endpoint TestSuite
vars:
  slashurl: '{{.REPO_SLASH_TEST}}'
  baseroute: '{{.APP_HOST}}/api/v1'
  appsroute: '{{.baseroute}}/applications'
testcases:
- name: ApplicationLifecycle
  steps:
    - type: http
      method: DELETE
      url: '{{.APP_HOST}}/api/v1/applications'
      headers:
      assertions:
      - result.statuscode ShouldEqual 204

- name: Add some Applications to register
  steps:
    - type: http
      method: PUT
      url: "{{.appsroute}}/urba/register-me-please/versions/1"
      body: |
        {
          "domain": "urba",
          "name": "register-me-please",
          "version": "1",
          "manifest": {
            "profile": "urba",
            "name": "register-me-please",
            "repository": "{{.slashurl}}/projects/URBA/repos/scangw",
            "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi eget enim turpis. Sed at nunc a lectus malesuada vehicula vitae tempus ante. Ut nec consequat augue. Aliquam imperdiet id tortor ut maximus. Phasellus facilisis nibh nec mauris tristique consequat. Donec nisi mauris, lobortis eu turpis vulputate, malesuada vehicula dolor. Ut mattis libero a sagittis faucibus. Fusce enim enim, consectetur at ultrices ut, mollis nec felis. In vehicula leo nec ex accumsan iaculis. Phasellus tempor dui sem, vel pulvinar enim molestie ut. Cras sit amet lacus eleifend velit consequat ultricies sed vitae nisl. Etiam mollis viverra justo, convallis pellentesque mauris vestibulum ac."
          }
        }
      headers:
      assertions:
      - result.statuscode ShouldEqual 201
